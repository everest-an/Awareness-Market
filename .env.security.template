# ============================================================================
# Awareness Network - Security Configuration Template
# ============================================================================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env file to version control!
# ============================================================================

# ============================================================================
# Core Configuration
# ============================================================================
DATABASE_URL=postgresql://user:password@localhost:5432/awareness_network
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# JWT Authentication
JWT_SECRET=CHANGE_ME_TO_A_SECURE_SECRET_AT_LEAST_32_CHARACTERS
JWT_EXPIRES_IN=1h
JWT_REFRESH_EXPIRES_IN=7d

# ============================================================================
# P1 Security: Data Encryption (Audit Logs)
# ============================================================================
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ENCRYPTION_KEY=

# Optional: Multiple keys for rotation
# ENCRYPTION_KEY_AUDIT=
# ENCRYPTION_KEY_PII=

# ============================================================================
# P1 Security: Database Backup
# ============================================================================
BACKUP_PATH=/tmp/backups
S3_BACKUP_BUCKET=awareness-network-backups
S3_BACKUP_PREFIX=postgresql
BACKUP_RETENTION_DAYS=30
BACKUP_VERIFICATION=true
ENABLE_BACKUP_RESTORE_TEST=false
BACKUP_NOTIFICATION_EMAIL=admin@example.com

# AWS Credentials for S3 backup
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1

# ============================================================================
# P1 Security: Rate Limiting
# ============================================================================
# Global API rate limit (requests per 15 minutes per IP)
GLOBAL_API_RATE_LIMIT=100

# Auth endpoint rate limit (attempts per 15 minutes per IP)
AUTH_RATE_LIMIT=5

# Password reset rate limit (requests per hour per IP)
PASSWORD_RESET_RATE_LIMIT=3

# ============================================================================
# P2 Security: API Key Auto-Rotation
# ============================================================================
# Enable auto-rotation (default: true)
ENABLE_AUTO_KEY_ROTATION=true

# Check interval in hours (default: 6)
KEY_ROTATION_CHECK_INTERVAL=6

# Notification email for key rotation alerts
KEY_ROTATION_NOTIFICATION_EMAIL=admin@example.com

# ============================================================================
# P2 Security: Session Management
# ============================================================================
# Idle timeout (minutes) - auto-logout after inactivity
SESSION_IDLE_TIMEOUT_MINUTES=30

# Absolute timeout (hours) - max session duration
SESSION_ABSOLUTE_TIMEOUT_HOURS=24

# Max concurrent sessions per user
MAX_CONCURRENT_SESSIONS=5

# Device tracking
ENABLE_DEVICE_TRACKING=true

# Cleanup interval (minutes)
SESSION_CLEANUP_INTERVAL_MINUTES=60

# Auto-revoke idle sessions
SESSION_AUTO_REVOKE_IDLE=true

# ============================================================================
# Email Service (for notifications)
# ============================================================================
EMAIL_SERVICE=sendgrid
SENDGRID_API_KEY=
EMAIL_FROM=noreply@example.com

# For AWS SES (alternative)
# EMAIL_SERVICE=ses
# AWS_SES_REGION=us-east-1

# For SMTP (alternative)
# EMAIL_SERVICE=smtp
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=
# SMTP_PASSWORD=
